{% extends "layouts/main.html" %}

{% block title %}Gestion des Stocks - Système de Gestion de Matériel{% endblock %}

{% block content %}
<!-- Vérification des droits d'administrateur -->
{% if not current_user.is_admin() %}
    <div class="alert alert-danger">
        <p>Vous n'avez pas l'autorisation d'accéder à cette page.</p>
        <p>Redirection automatique vers le tableau de bord...</p>
    </div>
    <script>
        setTimeout(function() {
            window.location.href = "{{ url_for('dashboard') }}";
        }, 3000);
    </script>
{% else %}
<!-- HTML pour la gestion des stocks... -->

<!-- Données pour le JavaScript -->
<script id="stock-data" type="application/json">
{{ materials|tojson|safe }}
</script>

<script id="api-urls" type="application/json">
{
  "materials": "{{ url_for('api_admin_materials') }}",
  "import": "{{ url_for('api_admin_materials_import') }}",
  "export": "{{ url_for('api_admin_materials_export') }}",
  "dashboard": "{{ url_for('dashboard') }}"
}
</script>
{% endif %}
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/stock_management.js') }}"></script>
{% endblock %}